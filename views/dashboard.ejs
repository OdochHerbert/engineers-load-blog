<!--BREADCRUMBS-->
<section id="breadcrumb">
    <div class="container">
        <ol class="breadcrumb">
            <li class="active">DashBoard</li>
        </ol>
    </div>
</section>
<!--MAIN SECTION-->
<section id="main">
    <!--Button to show col-3-->
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="list-group">
                    <a href="/dashboard" class="list-group-item main-color-bg">
                        <img class="img-circle" src="/images/<%=user.img%>" height="50px" width="60px">
                            <h4>
                                <%=name%>
                            </h4>
                        </a>
                        <div class="dropdown create">
                            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                Create content
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                                <li>
                                    <a type="button" class="modalBtn" data-id="sub10" data-id1='sub1'>Add Page</a>
                                </li>
                                <li>
                                    <a type="button" class="modalBtn" data-id="sub11" data-id1='sub1'>Add Selfie</a>
                                </li>
                            </ul>
                        </div>

                        <a href="/user/notifications" class="list-group-item">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                            Notifications


                            <%
                        if(typeof sub !='undefined' && sub.length>0){
                            var srNo=0
                            user.notifications.forEach(function(post){ 
                                srNo=srNo+1
                                %><% }) %>
                            <span class="badge"><%=srNo%></span>
                        <% } 
                        else{ %>
                            <tr>
                                <td colspan="3">No Data</td>
                            </tr>

                        <% } %>


                    </a>

                    <a href="/users/posts/<%=user._id%>" class="list-group-item">
                        <span class="glyphicon glyphicon-list-pencil" aria-hidden="true"></span>
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        Your Posts
                        <%
                                if(typeof sub !='undefined' && sub.length>0){
                                    var srNo=0
                                    user.posts.forEach(function(post){ 
                                        srNo=srNo+1
                                        %><% }) %>
                        <span class="badge"><%=srNo%></span>
                    <% } 
                                else{ %>
                        <tr>
                            <td colspan="3">No Data</td>
                        </tr>
                    <% } %>
                </span>
            </a>
            <a href="/site/underprogress" class="list-group-item">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                Ranking<span class="badge">
                    <%
                            if(typeof sub !='undefined'  && sub.length>0){
                                let srNo=0
                                let ranker=0
                                sub.forEach(function(post){ %>
                        <span>

                            <% if(post.author.name==name){
        srNo=srNo+1
        ranker=(typeof post.rank == 'undefined')? (ranker+0):ranker+post.rank %><%}%>


                        </span>

                        <%
                                    %>
                    <% }) %>
                    <span class="badge"><%=Math.round((((ranker/srNo)/100)*5))%></span>
                <% } 
                            else{ %>
                    <tr>
                        <td colspan="3">No Data</td>
                    </tr>
                <% } %>
            </span>
        </a>
        <a href="/site/underprogress" class="list-group-item">
            <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
            Projects
            <span class="badge">304</span>
        </a>
    </div>

    <div class="">

        <h4>
            Engineer-Rank %</h4>
        <div class="progress">
            <div class="progress-bar" role='progressbar' aria-valuenow="60" araia-valuemin="0" aria-valuemax="100" style="width: 60%">
                60%</div>
        </div>
        <h4>
            Acceptance %</h4>
        <div class="progress">
            <div class="progress-bar" role='progressbar' aria-valuenow="40" araia-valuemin="0" aria-valuemax="100" style="width: 40%">
                40%</div>
        </div>
    </div>
</div>
<div class="col-md-9">
    <div id='panelParent' class="panel panel-default">
        <div class="panel-heading main-color-bg">
            <h3 class='panel-title' id="panel-title">
                TOPICS</h3>
        </div>
        <div id='panel1' class="panel-body">

            <%
                        if(typeof sub !='undefined' && sub.length>0){
                            let char=[]
                            let n=0
                           
                            sub.forEach(function(post){ 
                            
                             char[n]=post.subreddit
                             n=n+1
                               
                                %>

                <!--<div class="col-md-3">
                                                                                    <div class="well dash-box">
                                                                                        <h2><span class="glyphicon glyphicon-user" aria-hidden="true">203</span></h2>
                                                                                        <h4><a href="/<%=post.subreddit%>"><%=post.subreddit%></a></h4>
                                                                                    </div>
                                                                                </div>-->
            <% })
                           let unchar=[...new Set(char)]

                           unchar.forEach(function(post){ 
                          
                              
                               %>

            <div class="col-md-3">
                <div class="well dash-box">
                    <h2>
                        <span class="bage" aria-hidden="true">
                            <% 
                                        
                                      var number=  char.filter(function(value){
                                            return value===post
                                    
                                
                                       }).length %>
                            <p class="badge"><%=number%></p>


                        </span>
                    </h2>
                    <h4>
                        <a style="color: #2c3e50" href="/<%=post%>"><%=post%></a>
                    </h4>
                </div>
            </div>
        <% })








                        }
                        else{ %>
            <tr>
                <td colspan="3">No Data</td>
            </tr>

        <% } %>


    </div>
</div>

<!--LATEST POSTS-->
<div id="panelParent2" class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">LATEST POSTS</h3>
    </div>
    <div id='panel2' class="panel-body">


        <table class="table table-striped table-hover">
            <%
                if(typeof sub !='undefined' && sub.length>0){
                    var srNo=0
                    sub.slice().reverse().forEach(function(post){ 
                        srNo=srNo+1
                        %>
                <% if(srNo<=5) {%>
                    <tr>


                        <td>
                            <a style="color: #2c3e50" href="/posts/<%= post._id %>/detail" title="Post Detail">
                                <strong><%= post.title%>
                                </strong>
                                <br>
                                    By:<%=post.author.name%>
                                    at
                                    <small>
                                        <%=post.date%></small>
                                </a>
                            </td>
                        </tr>
                    <%}%>

                <% })
                }
                else{ %>
                    <tr>
                        <td colspan="3">No Data</td>
                    </tr>

                <% } %>

            </table>
            <button id="reply" type="submit" class="btn btn-default">
                <a style="color: #2c3e50" href="/dashboard/all-posts">
                    Click Here to view All Posts</a>
            </button>


        </table>
    </div>
</div></div></div></div></div></section>
<!-- Modal -->
<div class="modal1" style="display:none" id="sub10"><div class="modal-thing"><span class="closeBtn" data-id="sub10">&times;</span><form action='/posts/new' method='POST'><h4>Add Page</h4><div class="form-group"><label>Post Title</label><input type="text" class="form-control" placeholder="Page Title" name='title'></div><div class="form-group">
<label>Post Body</label>
<textarea name="body" class="form-control" placeholder="Page Body"></textarea></div><div class="form-group">
<label>Post Reference</label>
<input type="text" class="form-control" placeholder="Add Some Tags" name='url'></div>

<!--WITH TIME TO TURN INTO DROPDOWN FORR ALL DEPARTMENTS-->
<div class="form-group">
    <label>DEPARTMENT</label>
    <select name='subreddit' value="subreddit">
        <option name='subreddit' value='ELECTRICAL AND ELECTRONICS'>ELECTRICAL AND ELECTRONICS</option>
        <option name='subreddit' value='MECHANICAL ENGINEERING'>MECHANICAL ENGINEERING</option>
        <option name='subreddit' value='COMPUTER ENGINEERING'>COMPUTER ENGINEERING</option>
        <option name='subreddit' value='WEB DEVELOPMENT'>WEB DEVELOPMENT</option>

    </select>


</div>
<button type="submit" class="btn btn-primary">Save changes</button></form></div></div><!-- PROFILE PHOTO MODAL 2--><div class="modal1" style="display:none" id="sub11"><div class="modal-thing"><span class="closeBtn" data-id="sub11">&times;</span><form action='/users/pic' method='POST' enctype='multipart/form-data'>

<h4>Change Profile Photo</h4>


<div class="form-group">
    <label for="image">Upload photo</label>
    <input type="file" class="form-control" placeholder="Add Some Tags" name='image' id="name"></div>


    <button type="submit" class="btn btn-primary">Save changes</button>

</form></div></div>

<script>function myFunction() {
    var panel1 = document.getElementById("panel1")
    var panel2 = document.getElementById("panel2")
    var panelParent1 = document.getElementById("panelParent")
    var panelParent2 = document.getElementById("panelParent2")


    // var para=document.createElement("p")
    // var parent=document.getElementById('parent')
    // parent.replaceChild(form,button)
    // var panel1=document.getElementById("panel1")
    // subm.type='submit'
    // form.appendChild(textBox)

    // CREATING ELEMENTS FOR NEW PANEL BODY
    var div1 = document.createElement('div')
    div1.class = 'panel-body'
    div1.innerHTML = sub
    panelParent2.remove()
    panelParent.replaceChild(div1, panel1)


}</script>
<script src="./ckeditor/ckeditor.js"></script>
<script>CKEDITOR.replace('body')</script>
