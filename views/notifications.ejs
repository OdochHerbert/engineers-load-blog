<header id="header">
    <div class="container">
        <div class="row">
            <div class="col-md-10">
                <h1> Dashboard</h1>
            </div>
            <div class="col-md-2">
                <div class="col-md-2">
                    <div class="dropdown create">
                        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Create content
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                            <li><a  type="button" class="modalBtn" data-id="sub10" data-id1='sub1'>Add Page</a></li>
                          <li><a type="button" class="modalBtn" data-id="sub11" data-id1='sub1'>Add Selfie</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>


<section id="breadcrumb">
    <div class="container">
        <ol class="breadcrumb">
            <li class="active">DashBoard</li>
        </ol>
    </div>
</section>

<section id="main">
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="list-group">
                    <a href="/dashboard" class="list-group-item  main-color-bg">
                          <img class="img-circle" src="/images/<%=user.img%>" height="50px" width="60px">
                        <h4>
                            <%=name%>
                        </h4>
                    </a>
                    <a href="users.html" class="list-group-item"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> Notifications
                    
                    
                    
                        <%
                        if(typeof sub !='undefined' && sub.length>0){
                            var srNo=0
                            user.notifications.forEach(function(post){ 
                                srNo=srNo+1
                                %>
                           <% }) %>
                           <span class="badge"><%=srNo%></span>
                       <% } 
                        else{ %>
                            <tr><td colspan="3">No Data</td></tr>
                    
                    <% } %>
                        
                    
                    
                    
                    
                    </a>

                    <a href="/users/posts/<%=user._id%>" class="list-group-item"><span class="glyphicon glyphicon-list-pencil" aria-hidden="true"></span> 
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Your Posts
                                <%
                                if(typeof sub !='undefined' && sub.length>0){
                                    var srNo=0
                                    user.posts.forEach(function(post){ 
                                        srNo=srNo+1
                                        %>
                                   <% }) %>
                                   <span class="badge"><%=srNo%></span>
                               <% } 
                                else{ %>
                                    <tr><td colspan="3">No Data</td></tr>
                            <% } %>
                            </span>
                            
                        
                        
                        </a>
                        <a href="posts.html" class="list-group-item"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Ranking<span class="badge">
                            <%
                            if(typeof sub !='undefined'  && sub.length>0){
                                let srNo=0
                                let ranker=0
                                sub.forEach(function(post){ %>
          <span>
      
      <% if(post.author.name==name){
        srNo=srNo+1
        ranker=(typeof post.rank == 'undefined')? (ranker+0):ranker+post.rank %>
      <%}%>
          </span>
      
                                    <%
      
                                    
                            
                                    %>
      
                               <% }) %>
                               <span class="badge"><%=Math.round((((ranker/srNo)/100)*5))%></span>
                               
                           <% } 
                            else{ %>
                                <tr><td colspan="3">No Data</td></tr>
                        
                        <% } %>
                            
                            
                            
                            
                            
                            </span></a>
                    <a href="users.html" class="list-group-item"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> Projects <span class="badge">304</span></a>
                </div>

                <div class="well">
                    <h4> Disk Spaced Used </h4>
                    <div class="progress">
                     <div class="progress-bar" role='progressbar' aria-valuenow="60" araia-valuemin="0" aria-valuemax="100" style="width: 60%">
                    60%</div>
                    </div>
                <h4> Bandwidth Used </h4>
                    <div class="progress">
                     <div class="progress-bar" role='progressbar' aria-valuenow="40" araia-valuemin="0" aria-valuemax="100" style="width: 40%">
                    40%</div>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div id='panelParent'class="panel panel-default">
                    <div class="panel-heading main-color-bg">
                        <h3 class='panel-title' id="panel-title"> TOPICS</h3>
                    </div>
                   
                
                <!--NOTIFICATIONS POSTS-->
    <div id="panelParent2" class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">LATEST NOTIFICATIONS</h3>
        </div>
        <div id='panel2' class="panel-body">
   
    
            <table  class="table table-striped table-hover">
                <%
                if(typeof sub !='undefined' && sub.length>0){
                    var srNo=0
                    for(let i=0;i<=user.notifications.length-1;i++){ 
                        srNo=srNo+1
                        %>
                        <% if(srNo<=5) {%>
                <tr>

                    
                    <td><a class="power" data-id="<%=i%>" data-id2="<%=user._id%>" href="/posts/<%=user.notIds[i]%>/detail" title="Post Detail"><strong><%=user.notifications[i]%>  

                        
                        <span></span>
                       <% sub.forEach(function(poster){%>


                            <span>   </span>

                            <% if(typeof user.notIds[i] != 'undefined' && user.notIds[i].toString()==poster._id.toString()){ %>
                             <span> <%=poster.title%></span>
     
                             <span> </span> 
     
                            <% } %>
                            <span> </span>
                       <% }) %>
                        
                       
                        
                        
                         </strong> <br>  at <small> Date</small> </a></td>
                </tr>
                <%}%>
                
                   <% }
                }
                else{ %>
                    <tr><td colspan="3">No Notifications</td></tr>
            
            <% } %>
                
            </table>
            <button id="reply" type="submit" class="btn btn-default"   >
                <a href="/dashboard/all-notifications"> Click Here to view All Posts</a>  
               </button>


           
                

               



            </table>
        </div>
    </div>

            </div>
    
            
            
            </div>
            
        </div>
    </div>
</section>
    <!-- Modal -->
    <div class="modal1" style="display:none" id="sub10">
           
        <div class="modal-thing">
          <span class="closeBtn" data-id="sub10">&times;</span>
          
     
          <form action='/posts/new' method='POST'>
           
             
      <h4 >Add Page</h4>
            
          
              
                 <div class="form-group">
                     <label>Post Title</label>
                     <input type="text" class="form-control" placeholder="Page Title" name='title'>
                 </div>
                 <div class="form-group">
                    <label>Post Body</label>
                    <textarea name="body" class="form-control" placeholder="Page Body" ></textarea>
                </div>
  
                <div class="form-group">
                    <label>Post Reference</label>
                    <input type="text" class="form-control" placeholder="Add Some Tags" name='url'>
                </div>
  
                <!--WITH TIME TO TURN INTO DROPDOWN FORR ALL DEPARTMENTS-->
                <div class="form-group">
                    <label>DEPARTMENT</label>
                    <select name='subreddit' value="subreddit">
                        <option name='subreddit' value='ELECTRICAL AND ELECTRONICS'>ELECTRICAL AND ELECTRONICS</option>
                        <option name='subreddit' value='MECHANICAL ENGINEERING'>MECHANICAL ENGINEERING</option>
                        <option name='subreddit' value='COMPUTER ENGINEERING'>COMPUTER ENGINEERING</option>
                        <option name='subreddit' value='WEB DEVELOPMENT'>WEB DEVELOPMENT</option>
                    
                    </select>
  
  
  
                    
                
    
            </div>
            <button type="submit" class="btn btn-primary">Save changes</button>
            
    </form>
    
      
            </div>
          </div>
        
    
      <!-- PROFILE PHOTO MODAL 2-->
      <div class="modal1" style="display:none" id="sub11">
               
        <div class="modal-thing">
          <span class="closeBtn" data-id="sub11">&times;</span>
          
          
     
      <form action='/users/pic' method='POST' enctype='multipart/form-data'>
              
                <h4>Change Profile Photo</h4>
              
             
                
                  <div class="form-group">
                      <label for="image">Upload photo</label>
                      <input type="file" class="form-control" placeholder="Add Some Tags" name='image' id="name">
                  </div>
      
              
              
                
                <button type="submit" class="btn btn-primary">Save changes</button>
             
      </form>
      
           
          </div>
        </div>
    
    
      <script>
        function myFunction(){
         var panel1=document.getElementById("panel1")
         var panel2=document.getElementById("panel2")
         var panelParent1=document.getElementById("panelParent")
         var panelParent2=document.getElementById("panelParent2")
         
         
        // var para=document.createElement("p")
         //var parent=document.getElementById('parent')
         //parent.replaceChild(form,button)
     //var panel1=document.getElementById("panel1")
        //subm.type='submit' 
         // form.appendChild(textBox)

         //CREATING ELEMENTS FOR NEW PANEL BODY
         var div1=document.createElement('div')
         div1.class='panel-body'
         div1.innerHTML=sub
         panelParent2.remove()
         panelParent.replaceChild(div1,panel1)

         
     
         
         
     
        }
     </script>

<script>
    CKEDITOR.replace('editor1')
</script>

  